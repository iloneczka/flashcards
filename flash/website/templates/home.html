{% extends 'base.html' %}

{% load static %}

{% block 'content' %}
<style>
  @media (max-width: 767px) {
    .nav-link, .navbar-brand {
      font-size: 15px;
    }
  }

  @media (min-width: 768px) and (max-width: 991px) {
    .nav-link, .navbar-brand {
      font-size: 15px;
    }

    .box-img {
      margin: 0 5px;
    }
  }

  .thumbnail {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
  }

  .thumbnail img {
    max-width: 100%;
    height: auto;
  }
</style>

<br/>
<div class="welcome-section">
  <h1 class="welcome-header" style="font-size: 25px;">Hello, {{ request.user.username }}!</h1>
  <h2>Welcome to the Flashcard Language Learning App!</h2>
</div>
<br/>
<br/>
<br/>
<div class="carousel slide" id="myCarousel">
  <div class="carousel-inner">
    <div class="item active">
      <div class="row">
        {% for box in unique_boxes %}
          <div class="col-md-3" style="position: relative;">
            {% if box.box %}
              <div class="thumbnail">
                <a href="#"><img src="{% static 'images/szablon.png' %}" alt="Box {{ box.box }}"></a>
                <div style="position: absolute; top: 30%; left: 50%; transform: translate(-50%, -50%); text-align: center; width: 100%;">
                  <h4 style="margin: 0;">Box {{ box.box.box_number }}</h4>
                </div>
              </div>
              <div class="caption text-center">
                <p>Przykładowy tekst</p>
                <a class="btn btn-mini btn-primary" href="{% url 'flashcard_program' box_number=box.box.box.number %}">» START</a>
              </div>
            {% endif %}
          </div>
        {% endfor %}
        <div class="col-md-3" style="position: relative;">
          <div class="thumbnail">
            <a href="#"><img src="{% static 'images/szablon.png' %}" alt="Create New Box"></a>
            <div style="position: absolute; top: 30%; left: 50%; transform: translate(-50%, -50%); text-align: center; width: 100%;">
              <h4 style="margin: 0;">Create New Box</h4>
            </div>
          </div>
          <div class="caption text-center">
            <form method="post" action="{% url 'create_new_box' %}">
              {% csrf_token %}
              <button type="submit" name="create_box" class="btn btn-mini btn-primary">CREATE NEW BOX</button>
            </form>
          </div>
        </div>
        <div class="col-md-3" style="position: relative;">
          <div class="thumbnail">
            <a href="#"><img src="{% static 'images/szablon.png' %}" alt="All cards"></a>
            <div style="position: absolute; top: 30%; left: 50%; transform: translate(-50%, -50%); text-align: center; width: 100%;">
              <h4 style="margin: 0;">All cards</h4>
            </div>
          </div>
          <div class="caption text-center">
            <p>Przykładowy tekst</p>
            <a class="btn btn-mini btn-primary" href="{% url 'flashcard_program' box_number=0 %}">» START</a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="control-box">
    <a data-slide="prev" href="#myCarousel" class="carousel-control left">‹</a>
    <a data-slide="next" href="#myCarousel" class="carousel-control right">›</a>
  </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script>
  $(document).ready(function() {
    $('.carousel').carousel({
      interval: 5000
    });

    $('form').submit(function(e) {
      e.preventDefault();
      $.ajax({
        url: $(this).attr('action'),
        method: 'POST',
        data: $(this).serialize(),
        success: function(data) {
          if (data.status === 'success') {
            var newBoxNumber = data.new_box_number;
            var newBoxHtml = '<div class="item"><div class="row"><div class="col-md-3" style="position: relative;">'+
              '<div class="thumbnail"><a href="#"><img src="{% static "images/szablon.png" %}" alt="Box ' + newBoxNumber + '"></a>'+
              '<div style="position: absolute; top: 30%; left: 50%; transform: translate(-50%, -50%); text-align: center; width: 100%;">'+
              '<h4 style="margin: 0;">Box ' + newBoxNumber + '</h4></div></div><div class="caption text-center">'+
              '<p>Przykładowy tekst</p><a class="btn btn-mini btn-primary" href="{% url "flashcard_program" box_number=' + newBoxNumber + ' %}">» START</a>'+
              '</div></div></div></div>';

            $('#myCarousel .carousel-inner').append(newBoxHtml);
            $('#myCarousel .item').removeClass('active');
            $('#myCarousel .item:last-child').addClass('active');
          }
        }
      });
    });
  });
</script>

{% endblock %}
